<!doctype html><html lang=en dir=ltr class=scroll-smooth data-default-appearance=light data-auto-appearance=true><head><meta charset=utf-8><meta http-equiv=content-language content="en"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=theme-color content="rgb(255,255,255)"><meta http-equiv=x-ua-compatible content="ie=edge"><title>How I upgraded eight PHP katas &#183; Pen-y-Fan</title><meta name=title content="How I upgraded eight PHP katas &#183; Pen-y-Fan"><meta name=description content="I recently upgrade eight PHP Katas from a minimum PHP 7.3 to a minimum of PHP 8.0. I used Rector, Easy Coding Standard (ECS) and PhpStan to help me. This is how I approached the upgrade and used these tools."><meta name=robots content="all"><link rel=canonical href=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/><link type=text/css rel=stylesheet href=/css/main.bundle.min.b15bed9c75c13ca3a738d365165ea777e34f367687cb02db8605dcf7786b76165f84c3f19f2c5d126d63d5597fe5ea155750bc6b0d4b822e90a9a8641b628437.css integrity="sha512-sVvtnHXBPKOnONNlFl6nd+NPNnaHywLbhgXc93hrdhZfhMPxnyxdEm1j1Vl/5eoVV1C8aw1Lgi6QqahkG2KENw=="><script type=text/javascript src=/js/appearance.min.1e44157c1e51b46341ce2c94716dd3dd1ef30c28e7d1c9f3b9db80877bfe72bc66b00d8a662f317840016acbed93c5f18c3d9268c8b957021ee74d0b04adf6c5.js integrity="sha512-HkQVfB5RtGNBziyUcW3T3R7zDCjn0cnzuduAh3v+crxmsA2KZi8xeEABasvtk8XxjD2SaMi5VwIe500LBK32xQ=="></script>
<script defer type=text/javascript id=script-bundle src=/js/main.bundle.min.9947db70e5b36e741e53f8531bd734741b3fc7a688f7b5d749fc5433c48efc252f47bdf44e471570a550fc051b87712799014040e6349b38d64448b94e84e45a.js integrity="sha512-mUfbcOWzbnQeU/hTG9c0dBs/x6aI97XXSfxUM8SO/CUvR730TkcVcKVQ/AUbh3EnmQFAQOY0mzjWREi5ToTkWg==" data-copy=Copy data-copied=Copied></script>
<link rel=apple-touch-icon sizes=180x180 href=/apple-touch-icon.png><link rel=icon type=image/png sizes=32x32 href=/favicon-32x32.png><link rel=icon type=image/png sizes=16x16 href=/favicon-16x16.png><link rel=manifest href=/site.webmanifest><meta property="og:title" content="How I upgraded eight PHP katas"><meta property="og:description" content="I recently upgrade eight PHP Katas from a minimum PHP 7.3 to a minimum of PHP 8.0. I used Rector, Easy Coding Standard (ECS) and PhpStan to help me. This is how I approached the upgrade and used these tools."><meta property="og:type" content="article"><meta property="og:url" content="https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2023-01-22T13:51:37+00:00"><meta property="article:modified_time" content="2023-01-22T13:51:37+00:00"><meta property="og:site_name" content="Pen-y-Fan"><meta name=twitter:card content="summary"><meta name=twitter:title content="How I upgraded eight PHP katas"><meta name=twitter:description content="I recently upgrade eight PHP Katas from a minimum PHP 7.3 to a minimum of PHP 8.0. I used Rector, Easy Coding Standard (ECS) and PhpStan to help me. This is how I approached the upgrade and used these tools."><script type=application/ld+json>[{"@context":"https://schema.org","@type":"Article","articleSection":"Posts","name":"How I upgraded eight PHP katas","headline":"How I upgraded eight PHP katas","abstract":"I recently upgrade eight PHP Katas from a minimum PHP 7.3 to a minimum of PHP 8.0. I used Rector, Easy Coding Standard (ECS) and PhpStan to help me. This is how I approached the upgrade and used these tools.","inLanguage":"en","url":"https:\/\/pen-y-fan.github.io\/2023\/01\/22\/how-i-upgraded-eight-php-katas\/","author":{"@type":"Person","name":"Michael Pritchard (AKA Pen-y-Fan)"},"copyrightYear":"2023","dateCreated":"2023-01-22T13:51:37\u002b00:00","datePublished":"2023-01-22T13:51:37\u002b00:00","dateModified":"2023-01-22T13:51:37\u002b00:00","keywords":["PHP","Resource","Rector","Easy Coding Standard (ECS)","PHP","PHPStan","PHPUnit"],"mainEntityOfPage":"true","wordCount":"4090"}]</script><meta name=author content="Michael Pritchard (AKA Pen-y-Fan)"><link href=https://github.com/Pen-y-Fan rel=me><link href=https://www.linkedin.com/in/michael-pritchard-340b4520/ rel=me><link href=https://www.reddit.com/user/Pen-y-Fan rel=me><link href=https://twitter.com/MikeAPritch rel=me></head><body class="flex flex-col h-screen px-6 m-auto text-lg leading-7 max-w-7xl bg-neutral text-neutral-900 dark:bg-neutral-800 dark:text-neutral sm:px-14 md:px-24 lg:px-32"><div id=the-top class="absolute flex self-center"><a class="px-3 py-1 text-sm -translate-y-8 rounded-b-lg bg-primary-200 focus:translate-y-0 dark:bg-neutral-600" href=#main-content><span class="font-bold text-primary-600 ltr:pr-2 rtl:pl-2 dark:text-primary-400">&darr;</span>Skip to main content</a></div><header class="py-6 font-semibold text-neutral-900 dark:text-neutral print:hidden sm:py-10"><nav class="flex items-start justify-between sm:items-center"><div class="flex flex-row items-center"><a href=/ class=mr-2><img src=/img/logo-100x100.jpg width=50 height=50 class="max-h-[10rem] max-w-[10rem] object-scale-down object-left" alt=Pen-y-Fan></a>
<a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" rel=me href=/>Pen-y-Fan</a></div><ul class="flex list-none flex-col ltr:text-right rtl:text-left sm:flex-row"><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/posts/ title=Posts>Blog</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/tags/ title=Tags>Tags</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/about/ title=About>About</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=/portfolio/ title=Portfolio>Portfolio</a></li><li class="mb-1 sm:mb-0 ltr:sm:mr-7 ltr:sm:last:mr-0 rtl:sm:ml-7 rtl:sm:last:ml-0"><a class="decoration-primary-500 hover:underline hover:decoration-2 hover:underline-offset-2" href=https://github.com/Pen-y-Fan title>GitHub</a></li></ul></nav></header><div class="relative flex flex-col grow"><main id=main-content class=grow><article><header class=max-w-prose><h1 class="mt-0 text-4xl font-extrabold text-neutral-900 dark:text-neutral">How I upgraded eight PHP katas</h1><div class="mt-8 mb-12 text-base text-neutral-500 dark:text-neutral-400 print:hidden"><div class="flex flex-row flex-wrap items-center"><time datetime="2023-01-22 13:51:37 +0000 UTC">22 January 2023</time><span class="px-2 text-primary-500">&#183;</span><span title="Reading time">20 mins</span></div></div></header><section class="flex flex-col max-w-full mt-0 prose dark:prose-invert lg:flex-row"><div class="order-first px-0 lg:order-last lg:max-w-xs ltr:lg:pl-8 rtl:lg:pr-8"><div class="toc ltr:pl-5 rtl:pr-5 print:hidden lg:sticky lg:top-10"><details open class="mt-0 overflow-hidden rounded-lg ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5"><summary class="block py-1 text-lg font-semibold cursor-pointer bg-neutral-100 text-neutral-800 ltr:-ml-5 ltr:pl-5 rtl:-mr-5 rtl:pr-5 dark:bg-neutral-700 dark:text-neutral-100 lg:hidden">Table of Contents</summary><div class="py-2 border-dotted border-neutral-300 ltr:-ml-5 ltr:border-l ltr:pl-5 rtl:-mr-5 rtl:border-r rtl:pr-5 dark:border-neutral-600"><nav id=TableOfContents><ul><li><a href=#why-did-i-upgrade>Why did I upgrade</a></li><li><a href=#how-did-i-upgrade>How did I upgrade</a><ul><li><a href=#required-tooling>Required tooling</a></li><li><a href=#create-a-branch>Create a branch</a></li><li><a href=#update-composerjson>update composer.json</a><ul><li><a href=#bump-the-minimum-php-version-to-8>Bump the minimum PHP version to 8</a></li><li><a href=#update-the-tooling>Update the tooling</a></li><li><a href=#update-the-scripts>update the scripts</a></li></ul></li><li><a href=#update-the-readmemd>Update the README.md</a></li><li><a href=#remove-editorconfig-and-composerlock-and-add-them-to-the-gitignore>Remove .editorconfig and composer.lock and add them to the .gitignore</a></li><li><a href=#upgrade-the-ecs-config-file>Upgrade the ECS config file</a></li><li><a href=#run-composer-install>Run composer install</a></li><li><a href=#run-the-tests>Run the tests</a></li><li><a href=#require-rector-php>Require rector PHP</a></li><li><a href=#check-the-code-standard>Check the code standard</a></li><li><a href=#check-the-static-analysis>Check the static analysis</a></li><li><a href=#rinse-and-repeat>Rinse and repeat</a></li><li><a href=#remove-rector>Remove Rector</a></li></ul></li><li><a href=#pull-request-pr>Pull Request (PR)</a></li><li><a href=#php-katas>PHP Katas</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div></details></div></div><div class="min-w-0 min-h-0 max-w-prose grow"><p><figure><img class="my-0 rounded-md" src=images/DALL%C2%B7E-2023-01-22_16-21-33-split-screen.png alt="Split screen"><figcaption>Split screen</figcaption></figure>Photo
generated by <a href=https://labs.openai.com/ target=_blank>DALL-E</a></p><div class="lead !mb-9 text-xl">I recently upgraded eight PHP Katas from a minimum PHP 7.3 to a minimum of PHP 8.0. I used Rector, Easy Coding Standard
(ECS) and PhpStan to help me. This is how I approached the upgrade and used these tools.</div><h2 id=why-did-i-upgrade class="relative group">Why did I upgrade <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#why-did-i-upgrade aria-label=Anchor>#</a></span></h2><p>I stated in my blog post
on &ldquo;<a href=https://pen-y-fan.github.io/2020/08/05/Why-I-enjoy-coding-Katas/ target=_blank>Why I enjoy coding katas</a>&rdquo; I had updated six
katas to be consistent, all with the same tooling and documentation. This means anyone who can try one Kata will know
how to pall any of the six others.</p><p>PHP 8 has been around for over two years now. The katas have already been bumped, two years ago, with support for PHP 8.
Now that PHP 7.4 is at the end of its life it was a good time to fully update the <strong>starting code</strong> to the latest PHP
8.0
standard. The most noticeable is the way <strong>Classes</strong> are constructed, and the removal of properties, which are now
generated
in the constructor.</p><p>If I open a Class and see properties, a constructor with parameters and the parameters being assigned to the properties,
I know I&rsquo;m in an &lsquo;old&rsquo;, pre-PHP 8 class.</p><p>It would therefore be good to upgrade all the starting code to be the PHP 8 style. The purpose of the Kata is to
practice refactoring. The starting code should not need upgrading.</p><h2 id=how-did-i-upgrade class="relative group">How did I upgrade <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#how-did-i-upgrade aria-label=Anchor>#</a></span></h2><p>I&rsquo;ve already completed six of the eight Kata. I have a plan of attack.</p><ol><li>create a ‘php8’ branch</li><li>update composer.json</li><li>update the readme.md</li><li>remove .editorconfig and composer.lock</li><li>add them to the .gitignore</li><li>upgrade the easy coding standard config file (ecs.php)</li><li>run composer install</li><li>require Rector</li><li>run the tests</li><li>check the code standard</li><li>check the static analysis</li><li>repeat 9-11 until I&rsquo;m satisfied</li><li>remove Rector</li><li>push the code and create a PR</li></ol><h3 id=required-tooling class="relative group">Required tooling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#required-tooling aria-label=Anchor>#</a></span></h3><p>All the katas have:</p><ul><li><a href=https://phpunit.de/ target=_blank>PHPUnit</a> ^9.5 - for running the tests</li><li><a href=https://github.com/phpstan/phpstan target=_blank>PhpStan</a> ^0.12.25 - for static analysis</li><li><a href=https://github.com/symplify/easy-coding-standard target=_blank>Easy Coding Standard (ECS)</a> ^9.0 - for code standard</li><li>PHP ^7.3|^8.0 - From PHP 7.3 to PHP 8.2+</li></ul><p>I want all the katas to have the latest versions of these tools, ECS also needs an updated config file.</p><p>I also want to temporarily pull in <a href=https://getrector.org/documentation target=_blank>Rector PHP</a>, to try and automatically upgrade
the code.</p><h3 id=create-a-branch class="relative group">Create a branch <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#create-a-branch aria-label=Anchor>#</a></span></h3><p>I have already forked the code from <a href=https://github.com/emilybache/Racing-Car-Katas target=_blank>emilybache/Racing-Car-Katas</a> to
my repo and cloned it to my computer.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl><span class=nb>cd</span> Racing-Car-Katas/php
</span></span><span class=line><span class=cl>git checkout -b php8
</span></span></code></pre></div><h3 id=update-composerjson class="relative group">update composer.json <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#update-composerjson aria-label=Anchor>#</a></span></h3><p>The <strong>composer.json</strong> file can be updated in three parts:</p><h4 id=bump-the-minimum-php-version-to-8 class="relative group">Bump the minimum PHP version to 8 <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#bump-the-minimum-php-version-to-8 aria-label=Anchor>#</a></span></h4><p>To bump the minimum required PHP version to 8, update the php requirement:</p><p>From:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;require&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;php&#34;</span><span class=p>:</span> <span class=s2>&#34;^7.3|^8.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=err>,</span>
</span></span></code></pre></div><p>To:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;require&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;php&#34;</span><span class=p>:</span> <span class=s2>&#34;^8.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=err>,</span>
</span></span></code></pre></div><h4 id=update-the-tooling class="relative group">Update the tooling <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#update-the-tooling aria-label=Anchor>#</a></span></h4><p>By this point, I had already locked in the tooling, by using composer remove <package>&ndash;dev and re-installing using
composer require <package>&ndash;dev, while running PHP 8.0. Composer installed the latest version.</p><p>Was:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;require-dev&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpunit/phpunit&#34;</span><span class=p>:</span> <span class=s2>&#34;^9.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpstan/phpstan&#34;</span><span class=p>:</span> <span class=s2>&#34;^0.12.25&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpstan/phpstan-phpunit&#34;</span><span class=p>:</span> <span class=s2>&#34;^0.12.10&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;symplify/easy-coding-standard&#34;</span><span class=p>:</span> <span class=s2>&#34;^9.0&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;symplify/phpstan-extensions&#34;</span><span class=p>:</span> <span class=s2>&#34;^9.0&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=err>,</span>
</span></span></code></pre></div><p>I had the exact versions from the previous kata, which I had already upgraded. Now:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;require-dev&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpunit/phpunit&#34;</span><span class=p>:</span> <span class=s2>&#34;^9.5&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpstan/phpstan&#34;</span><span class=p>:</span> <span class=s2>&#34;^1.9&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpstan/phpstan-phpunit&#34;</span><span class=p>:</span> <span class=s2>&#34;^1.3&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;symplify/easy-coding-standard&#34;</span><span class=p>:</span> <span class=s2>&#34;^11.1&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;symplify/phpstan-extensions&#34;</span><span class=p>:</span> <span class=s2>&#34;^11.1&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span><span class=err>,</span>
</span></span></code></pre></div><h4 id=update-the-scripts class="relative group">update the scripts <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#update-the-scripts aria-label=Anchor>#</a></span></h4><p>Remove the unnecessary scripts and update the ecs scripts, which get the folder from the config file.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-json data-lang=json><span class=line><span class=cl><span class=s2>&#34;scripts&#34;</span><span class=err>:</span> <span class=p>{</span>
</span></span><span class=line><span class=cl><span class=err>-</span> <span class=nt>&#34;checkcode&#34;</span><span class=p>:</span> <span class=s2>&#34;phpcs src tests --standard=PSR12&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>-</span> <span class=nt>&#34;fixcode&#34;</span><span class=p>:</span> <span class=s2>&#34;phpcbf src tests --standard=PSR12&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>-</span> <span class=nt>&#34;test&#34;</span><span class=p>:</span> <span class=s2>&#34;phpunit&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;tests&#34;</span><span class=p>:</span> <span class=s2>&#34;phpunit&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;test-coverage&#34;</span><span class=p>:</span> <span class=s2>&#34;phpunit --coverage-html build/coverage&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>-</span><span class=nt>&#34;check-cs&#34;</span><span class=p>:</span> <span class=s2>&#34;ecs check src tests --ansi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>+</span><span class=nt>&#34;check-cs&#34;</span><span class=p>:</span> <span class=s2>&#34;ecs check --ansi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>-</span><span class=nt>&#34;fix-cs&#34;</span><span class=p>:</span> <span class=s2>&#34;ecs check src tests --fix --ansi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=err>+</span><span class=nt>&#34;fix-cs&#34;</span><span class=p>:</span> <span class=s2>&#34;ecs check --fix --ansi&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl><span class=nt>&#34;phpstan&#34;</span><span class=p>:</span> <span class=s2>&#34;phpstan analyse --ansi&#34;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h3 id=update-the-readmemd class="relative group">Update the README.md <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#update-the-readmemd aria-label=Anchor>#</a></span></h3><p>The PHP version of README.md needs to be consistent across all the Katas.</p><p>If anyone pulls one Kata they will find the other PHP Kata to be consistent and familiar. This means they can
get on with the Kata rather than working out how each one is set up.</p><h3 id=remove-editorconfig-and-composerlock-and-add-them-to-the-gitignore class="relative group">Remove .editorconfig and composer.lock and add them to the .gitignore <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#remove-editorconfig-and-composerlock-and-add-them-to-the-gitignore aria-label=Anchor>#</a></span></h3><p>The <strong>.editorconfig</strong> isn’t required, the code standard will take care of incorrect spaces.</p><p><strong>composer.lock</strong> can be removed, as a <code>composer install</code> will regenerate a composer.lock</p><p><strong>.gitignore</strong> can be updated to ignore these files:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>/.idea
</span></span><span class=line><span class=cl>/build
</span></span><span class=line><span class=cl>/vendor
</span></span><span class=line><span class=cl>/.vscode
</span></span><span class=line><span class=cl>/.editorconfig
</span></span><span class=line><span class=cl>/.phpunit.result.cache
</span></span><span class=line><span class=cl>/composer.lock
</span></span></code></pre></div><h3 id=upgrade-the-ecs-config-file class="relative group">Upgrade the ECS config file <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#upgrade-the-ecs-config-file aria-label=Anchor>#</a></span></h3><p>A new <strong>ecs.php</strong> can be copied from previous projects. A new template can be created by running <code>vendor/bin/ecs init</code>
which will update ECS to the latest config. The <a href=https://github.com/symplify/easy-coding-standard target=_blank>exact config</a> can
be tailored to each project.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>declare</span><span class=p>(</span><span class=nx>strict_types</span><span class=o>=</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PhpCsFixer\Fixer\ArrayNotation\ArraySyntaxFixer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>PhpCsFixer\Fixer\Strict\DeclareStrictTypesFixer</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Symplify\EasyCodingStandard\Config\ECSConfig</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Symplify\EasyCodingStandard\ValueObject\Set\SetList</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1>// composer require --dev symplify/easy-coding-standard
</span></span></span><span class=line><span class=cl><span class=c1>// vendor/bin/ecs init
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=k>static</span> <span class=k>function</span> <span class=p>(</span><span class=nx>ECSConfig</span> <span class=nv>$ecsConfig</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>paths</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/src&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/tests&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/ecs.php&#39;</span><span class=p>,</span>  <span class=c1>// check this file too!
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>skip</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=c1>// rules to skip
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// run and fix, one by one
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>sets</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>SPACES</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>ARRAY</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>DOCBLOCK</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>NAMESPACES</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>CONTROL_STRUCTURES</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>CLEAN_CODE</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>STRICT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>PSR_12</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>SetList</span><span class=o>::</span><span class=na>PHPUNIT</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// add declare(strict_types=1); to all php files:
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>rule</span><span class=p>(</span><span class=nx>DeclareStrictTypesFixer</span><span class=o>::</span><span class=na>class</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// change $array = array(); to $array = [];
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>ruleWithConfiguration</span><span class=p>(</span><span class=nx>ArraySyntaxFixer</span><span class=o>::</span><span class=na>class</span><span class=p>,</span> <span class=p>[</span>
</span></span><span class=line><span class=cl>       <span class=s1>&#39;syntax&#39;</span> <span class=o>=&gt;</span> <span class=s1>&#39;short&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// [default: PHP_EOL]; other options: &#34;\n&#34;
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>lineEnding</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>&#34;</span><span class=p>);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>Remove the config file <strong>ecs.yaml</strong>. ECS used to use a yaml file format for its config setting. The php style config
was introduced several years ago, which is a much better completion and has no more errors due to tabs or spaces!</p><h3 id=run-composer-install class="relative group">Run composer install <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#run-composer-install aria-label=Anchor>#</a></span></h3><p>The Kata is ready to be started, with the required tooling.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>composer install
</span></span></code></pre></div><h3 id=run-the-tests class="relative group">Run the tests <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#run-the-tests aria-label=Anchor>#</a></span></h3><p>Make sure all the tests are passing, although this Kata starts with a failing test.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pu.bat
</span></span><span class=line><span class=cl><span class=c1># or composer tests</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>composer tests
</span></span><span class=line><span class=cl>&gt; phpunit
</span></span><span class=line><span class=cl>PHPUnit 9.5.27 by Sebastian Bergmann and contributors.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Runtime:       PHP 8.0.27
</span></span><span class=line><span class=cl>Configuration: E:\laragon\cli\Racing-Car-Katas\php\phpunit.xml.dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....IEF.F                                                           9 / 9 (100%)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Time: 00:00.038, Memory: 4.00 MB
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>There was 1 error:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1) Tests\TextConverter\HtmlPagesConverterTest::testFoo
</span></span><span class=line><span class=cl>fopen(foo): Failed to open stream: No such file or directory
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>E:\laragon\cli\Racing-Car-Katas\php\src\TextConverter\HtmlPagesConverter.php:18
</span></span><span class=line><span class=cl>E:\laragon\cli\Racing-Car-Katas\php\tests\TextConverter\HtmlPagesConverterTest.php:14
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>There were 2 failures:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1) Tests\TextConverter\HtmlTextConverterTest::testFoo
</span></span><span class=line><span class=cl>Failed asserting that two strings are identical.
</span></span><span class=line><span class=cl>--- Expected
</span></span><span class=line><span class=cl>+++ Actual
</span></span><span class=line><span class=cl>@@ @@
</span></span><span class=line><span class=cl>-&#39;fixme&#39;
</span></span><span class=line><span class=cl>+&#39;foo&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>E:\laragon\cli\Racing-Car-Katas\php\tests\TextConverter\HtmlTextConverterTest.php:15
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>2) Tests\TurnTicketDispenser\TicketDispenserTest::testFoo
</span></span><span class=line><span class=cl>Failed asserting that 0 is identical to -1.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>E:\laragon\cli\Racing-Car-Katas\php\tests\TurnTicketDispenser\TicketDispenserTest.php:16
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>--
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>There was 1 incomplete test:
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>1) Tests\TelemetrySystem\TelemetryDiagnosticControlsTest::testCheckTransmissionShouldSendAndReceiveDiagnosticMessage
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>E:\laragon\cli\Racing-Car-Katas\php\tests\TelemetrySystem\TelemetryDiagnosticControlsTest.php:14
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ERRORS!
</span></span><span class=line><span class=cl>Tests: 9, Assertions: 10, Errors: 1, Failures: 2, Incomplete: 1.
</span></span><span class=line><span class=cl>Script phpunit handling the tests event returned with error code 2
</span></span></code></pre></div><p>Ideally, full test coverage is preferred, but this Kata doesn&rsquo;t start that way, the upgraded code may need to be
reviewed
later.</p><h3 id=require-rector-php class="relative group">Require rector PHP <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#require-rector-php aria-label=Anchor>#</a></span></h3><p>Require rector PHP and initialise it, following the <a href=https://getrector.org/documentation target=_blank>documentation</a>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>composer require rector/rector --dev
</span></span><span class=line><span class=cl><span class=c1># …</span>
</span></span><span class=line><span class=cl><span class=c1># Package operations: 1 install, 0 updates, 0 removals</span>
</span></span><span class=line><span class=cl><span class=c1># - Downloading rector/rector (0.15.3)</span>
</span></span><span class=line><span class=cl><span class=c1># - Installing rector/rector (0.15.3): Extracting archive</span>
</span></span><span class=line><span class=cl><span class=c1># …</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>vendor/bin/rector init
</span></span><span class=line><span class=cl><span class=c1># or vendor\bin\rector.bat init</span>
</span></span><span class=line><span class=cl><span class=c1>#  [OK] &#34;rector.php&#34; config file was added</span>
</span></span></code></pre></div><p>The init command will automatically generate a starter <strong>rector.php</strong> config, this file can be edited to help, the nice
thing about the config is how easy it is to read. In the future, if PHP 8.1 or PHP 8.2 is the minimum then change the
<code>LevelSetList::UP_TO_PHP_&lt;version></code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=o>&lt;?</span><span class=nx>php</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>declare</span><span class=p>(</span><span class=nx>strict_types</span><span class=o>=</span><span class=mi>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Rector\CodeQuality\Rector\ClassMethod\ReturnTypeFromStrictScalarReturnExprRector</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Rector\Config\RectorConfig</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Rector\Set\ValueObject\LevelSetList</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=k>use</span> <span class=nx>Rector\TypeDeclaration\Rector\ClassMethod\ReturnTypeFromStrictNativeCallRector</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>return</span> <span class=k>static</span> <span class=k>function</span> <span class=p>(</span><span class=nx>RectorConfig</span> <span class=nv>$rectorConfig</span><span class=p>)</span><span class=o>:</span> <span class=nx>void</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>   <span class=nv>$rectorConfig</span><span class=o>-&gt;</span><span class=na>paths</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/src&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=no>__DIR__</span> <span class=o>.</span> <span class=s1>&#39;/tests&#39;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// register rules to add return type when known
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$rectorConfig</span><span class=o>-&gt;</span><span class=na>rules</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=nx>ReturnTypeFromStrictNativeCallRector</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=nx>ReturnTypeFromStrictScalarReturnExprRector</span><span class=o>::</span><span class=na>class</span><span class=p>,</span>
</span></span><span class=line><span class=cl>   <span class=p>]);</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>   <span class=c1>// define sets of rules
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nv>$rectorConfig</span><span class=o>-&gt;</span><span class=na>sets</span><span class=p>([</span>
</span></span><span class=line><span class=cl>       <span class=nx>LevelSetList</span><span class=o>::</span><span class=na>UP_TO_PHP_80</span>
</span></span><span class=line><span class=cl>   <span class=p>]);</span>
</span></span><span class=line><span class=cl><span class=p>};</span>
</span></span></code></pre></div><p>To see a preview of suggested changes, run the rector command with &ndash;dry-run option:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>vendor<span class=se>\b</span>in<span class=se>\r</span>ector.bat --dry-run
</span></span><span class=line><span class=cl><span class=c1># or vendor/bin/rector --dry-run</span>
</span></span></code></pre></div><p>The output was reviewed, and 13 files would be updated. Most of the changes where to do with updating the constructor
e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl> class Leaderboard
</span></span><span class=line><span class=cl> {
</span></span><span class=line><span class=cl><span class=gd>---    /**
</span></span></span><span class=line><span class=cl><span class=gd>---     * @var Race[]
</span></span></span><span class=line><span class=cl><span class=gd>---     */
</span></span></span><span class=line><span class=cl><span class=gd>---    private $races;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gs>---
</span></span></span><span class=line><span class=cl><span class=gs></span><span class=gd>---    public function __construct(array $races)
</span></span></span><span class=line><span class=cl><span class=gd>---    {
</span></span></span><span class=line><span class=cl><span class=gd>---        $this-&gt;races = $races;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    /**
</span></span></span><span class=line><span class=cl><span class=gi>+++     * @param \RacingCar\Leaderboard\Race[] $races
</span></span></span><span class=line><span class=cl><span class=gi>+++     */
</span></span></span><span class=line><span class=cl><span class=gi>+++    public function __construct(private array $races)
</span></span></span><span class=line><span class=cl><span class=gi>+++    {
</span></span></span><span class=line><span class=cl><span class=gi></span>     }
</span></span></code></pre></div><p>The other changes were to add the <code>implements \Stringable</code> when the class uses <code>__toString</code> e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>namespace RacingCar\Leaderboard;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gd>--- class Driver
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++ class Driver implements \Stringable
</span></span></span><span class=line><span class=cl><span class=gi></span> {
</span></span><span class=line><span class=cl>     public $name;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gu>@@ @@
</span></span></span><span class=line><span class=cl><span class=gu></span>         $this-&gt;country = $country;
</span></span><span class=line><span class=cl>     }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gd>---    public function __toString()
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    public function __toString(): string
</span></span></span><span class=line><span class=cl><span class=gi></span>     {
</span></span><span class=line><span class=cl><span class=gd>---        return &#34;{$this-&gt;name} {$this-&gt;country}&#34;;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++        return (string) &#34;{$this-&gt;name} {$this-&gt;country}&#34;;
</span></span></span><span class=line><span class=cl><span class=gi></span>     }
</span></span><span class=line><span class=cl> }
</span></span></code></pre></div><p>Another change was to inline the parameter type e.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>10) src/TelemetrySystem/TelemetryClient.php:10
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ---------- begin diff ----------
</span></span><span class=line><span class=cl><span class=gu>@@ @@
</span></span></span><span class=line><span class=cl><span class=gu></span> {
</span></span><span class=line><span class=cl>     public const DIAGNOSTIC_MESSAGE = &#39;AT#UD&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gd>---    private $onlineStatus = false;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    private bool $onlineStatus = false;
</span></span></span><span class=line><span class=cl><span class=gi></span>
</span></span><span class=line><span class=cl><span class=gd>---    private $diagnosticMessageJustSent = false;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    private bool $diagnosticMessageJustSent = false;
</span></span></span></code></pre></div><p>Although in the test cases, the full class address is used. The Driver class would be better to be a use statement:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl> class LeaderboardTest extends TestCase
</span></span><span class=line><span class=cl> {
</span></span><span class=line><span class=cl><span class=gd>---    private $driver1;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    private \RacingCar\Leaderboard\Driver $driver1;
</span></span></span></code></pre></div><p>An interesting one was the <code>random_int</code> rector:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>5) src/TirePressureMonitoring/Sensor.php:20
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    ---------- begin diff ----------
</span></span><span class=line><span class=cl><span class=gu>@@ @@
</span></span></span><span class=line><span class=cl><span class=gu></span>     private static function getSamplePressure()
</span></span><span class=line><span class=cl>     {
</span></span><span class=line><span class=cl>         // placeholder implementation that simulates a real sensor in a real tyre
</span></span><span class=line><span class=cl><span class=gd>---        return 6 * mt_rand() / mt_getrandmax() * mt_rand() / mt_getrandmax();
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++        return 6 * random_int(0, mt_getrandmax()) / mt_getrandmax() * random_int(0, mt_getrandmax()) / mt_getrandmax();
</span></span></span><span class=line><span class=cl><span class=gi></span>     }
</span></span><span class=line><span class=cl> }
</span></span><span class=line><span class=cl>    ----------- end diff -----------
</span></span></code></pre></div><p>This improvement would have been easily missed.</p><p>I wanted to double-check the output is comparable, by opening an interactive php shell:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nx>php</span> <span class=o>-</span><span class=nx>a</span>
</span></span><span class=line><span class=cl><span class=nx>Interactive</span> <span class=nx>shell</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.28789230076317</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.59193628730294</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>2.3353527303516</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>3.9111024607976</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>1.3882777102362</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>mt_rand</span><span class=p>()</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>1.3381505674129</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.33623375077603</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.21711217311234</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>1.8174108426317</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.59516582006594</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.13920652881307</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>0.56419425470649</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>1.1058509887747</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>4.1742725948899</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>1.8491269459026</span>
</span></span><span class=line><span class=cl><span class=nx>php</span> <span class=o>&gt;</span> <span class=k>echo</span> <span class=mi>6</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>()</span> <span class=o>*</span> <span class=nx>random_int</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span> <span class=nx>mt_getrandmax</span><span class=p>())</span> <span class=o>/</span> <span class=nx>mt_getrandmax</span><span class=p>();</span>
</span></span><span class=line><span class=cl><span class=mf>2.8255782588891</span>
</span></span></code></pre></div><p>Ok, the recommended change is giving a similar &lsquo;random&rsquo; output.</p><p>One other PHP 8 improvement was <code>str_contrains</code>:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>---            if (strpos($line, &#39;PAGE_BREAK&#39;) !== false) {
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++            if (str_contains($line, &#39;PAGE_BREAK&#39;)) {
</span></span></span></code></pre></div><p>Much nicer to read!</p><p>I’m happy with what I have seen. I am also confident after upgrading six other Kata’s that this will not break the code!</p><p>To make changes happen, run the bare command:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>vendor<span class=se>\b</span>in<span class=se>\r</span>ector.bat
</span></span><span class=line><span class=cl><span class=c1># or vendor/bin/rector</span>
</span></span></code></pre></div><p>I can re-run the tests can confirm the tests are giving the same results:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pu.bat
</span></span><span class=line><span class=cl><span class=c1># or composer tests</span>
</span></span></code></pre></div><p>The results are exactly the same:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Runtime:       PHP 8.0.27
</span></span><span class=line><span class=cl>Configuration: E:\laragon\cli\Racing-Car-Katas\php\phpunit.xml.dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....IEF.F                                                           9 / 9 (100%)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Time: 00:00.016, Memory: 4.00 MB
</span></span><span class=line><span class=cl># ….
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ERRORS!
</span></span><span class=line><span class=cl>Tests: 9, Assertions: 10, Errors: 1, Failures: 2, Incomplete: 1.
</span></span><span class=line><span class=cl>Script phpunit handling the tests event returned with error code 2
</span></span></code></pre></div><h3 id=check-the-code-standard class="relative group">Check the code standard <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#check-the-code-standard aria-label=Anchor>#</a></span></h3><p>Run <code>cc.bat</code> or <code>composer check-cs</code> to check the code quality</p><p>Most of the fixes are for <strong>StandaloneLinePromotedPropertyFixer</strong></p><p>E.g.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>-class TurnTicket
</span></span></span><span class=line><span class=cl><span class=gd>-{
</span></span></span><span class=line><span class=cl><span class=gd>-    public function __construct(private int $turnNumber)
</span></span></span><span class=line><span class=cl><span class=gd>-    {
</span></span></span><span class=line><span class=cl><span class=gd>-    }
</span></span></span><span class=line><span class=cl><span class=gd></span>
</span></span><span class=line><span class=cl><span class=gi>+class TurnTicket
</span></span></span><span class=line><span class=cl><span class=gi>+{
</span></span></span><span class=line><span class=cl><span class=gi>+    public function __construct(
</span></span></span><span class=line><span class=cl><span class=gi>+        private int $turnNumber
</span></span></span><span class=line><span class=cl><span class=gi>+    ) {
</span></span></span><span class=line><span class=cl><span class=gi>+    }
</span></span></span></code></pre></div><p>Which makes the code easier to read, especially when there are multiple properties.</p><p>Most of the other fixes are to do with spaces, brace positions and gaps between imports, all cosmetic changes, which
keep the code confident to read.</p><ul><li>PhpCsFixer\Fixer\Basic\CurlyBracesPositionFixer</li><li>PhpCsFixer\Fixer\Import\SingleLineAfterImportsFixer</li><li>PhpCsFixer\Fixer\Whitespace\NoWhitespaceInBlankLineFixer</li></ul><p>One change I don’t want was <strong>NoUnusedImportsFixer</strong>, as this is starter code with incomplete tests I want to leave the
import as a clue to what to start testing.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>// This import is a clue, I want to leave it in the starting code:
</span></span><span class=line><span class=cl><span class=gd>---use RacingCar\TelemetrySystem\TelemetryDiagnosticControls;
</span></span></span><span class=line><span class=cl><span class=gd></span>
</span></span><span class=line><span class=cl>use PHPUnit\Framework\TestCase;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class TelemetryDiagnosticControlsTest extends TestCase
</span></span><span class=line><span class=cl> {
</span></span><span class=line><span class=cl>    public function testCheckTransmissionShouldSendAndReceiveDiagnosticMessage(): void
</span></span><span class=line><span class=cl>     {
</span></span><span class=line><span class=cl>         $this-&gt;markTestIncomplete();
</span></span><span class=line><span class=cl>     }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>I can add this rule to the skip rules section of <strong>ecs.php</strong> config file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=nv>$ecsConfig</span><span class=o>-&gt;</span><span class=na>skip</span><span class=p>([</span>
</span></span><span class=line><span class=cl>   <span class=c1>// keep unused imports until the refactor is complete
</span></span></span><span class=line><span class=cl><span class=c1></span>   <span class=nx>PhpCsFixer\Fixer\Import\NoUnusedImportsFixer</span><span class=o>::</span><span class=na>class</span>
</span></span><span class=line><span class=cl><span class=p>]);</span>
</span></span></code></pre></div><p>The other <strong><em>problem</em></strong> was the report was too long to read, I ran the script to pipe the output to a text file:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>vendor<span class=se>\b</span>in<span class=se>\e</span>cs.bat --no-ansi &gt; ecsoutput.txt
</span></span></code></pre></div><p>I can now open <strong>ecsoutput.txt</strong> in my IDE and review the changes. It is harder to read as the colour coding has been
stripped. At this stage, I’m more interested in the rules used, as I don’t want the starter code to be removed.
Finding <strong>Applied checkers:</strong> and reviewing the rules that would be applied to each file.</p><p>I’m now satisfied with the results, so I can run the fix</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>fc.bat
</span></span><span class=line><span class=cl><span class=c1># or composer fix-cs</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>// ….
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> [OK] 21 errors successfully fixed and no other errors found!
</span></span></code></pre></div><p>I can delete the <strong>ecsoutput.txt</strong> file, which is no longer needed.</p><p>The tests can be re-run, I’m not expecting any surprises, as the changes to code style are more cosmetic, so running the
tests is a precaution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>pu.bat
</span></span><span class=line><span class=cl><span class=c1># or composer tests</span>
</span></span></code></pre></div><p>The results are the same:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>Runtime:       PHP 8.0.27
</span></span><span class=line><span class=cl>Configuration: E:\laragon\cli\Racing-Car-Katas\php\phpunit.xml.dist
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>....IEF.F                                                           9 / 9 (100%)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Time: 00:00.015, Memory: 4.00 MB
</span></span><span class=line><span class=cl># ….
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>ERRORS!
</span></span><span class=line><span class=cl>Tests: 9, Assertions: 10, Errors: 1, Failures: 2, Incomplete: 1.
</span></span><span class=line><span class=cl>Script phpunit handling the tests event returned with error code 2
</span></span></code></pre></div><p>I’m happy the tests are the same, so can move on to the next thing.</p><h3 id=check-the-static-analysis class="relative group">Check the static analysis <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#check-the-static-analysis aria-label=Anchor>#</a></span></h3><p>Before the analyser can be run the config file needs to be updated:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl>includes:
</span></span><span class=line><span class=cl>   - vendor/symplify/phpstan-extensions/config/config.neon
</span></span><span class=line><span class=cl>   - vendor/phpstan/phpstan-phpunit/extension.neon
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>parameters:
</span></span><span class=line><span class=cl>   paths:
</span></span><span class=line><span class=cl>       - src
</span></span><span class=line><span class=cl>       - tests
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=gd>---   # Level 8 is the highest
</span></span></span><span class=line><span class=cl><span class=gd>---   level: 8
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++   # max is the highest level
</span></span></span><span class=line><span class=cl><span class=gi>+++   level: max
</span></span></span><span class=line><span class=cl><span class=gi></span>
</span></span><span class=line><span class=cl>   checkGenericClassInNonGenericObjectType: false
</span></span></code></pre></div><p>Two years ago <strong>8</strong> was the highest level, it’s now <strong>9</strong>, and we can set it to <strong>max</strong>.</p><p>Run <strong>PhpStan</strong> static analyser:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>ps.bat
</span></span><span class=line><span class=cl><span class=c1># or composer phpstan</span>
</span></span></code></pre></div><p>The output shows each file with the error, there are 33 error in total:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>λ ps.bat
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>composer phpstan
</span></span><span class=line><span class=cl>&gt; phpstan analyse --ansi
</span></span><span class=line><span class=cl>Note: Using configuration file E:\laragon\cli\Racing-Car-Katas\php\phpstan.neon.
</span></span><span class=line><span class=cl> 20/20 [============================] 100%
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\Leaderboard\Driver.php
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  9      Property RacingCar\Leaderboard\Driver::$name has no type specified.
</span></span><span class=line><span class=cl>  11     Property RacingCar\Leaderboard\Driver::$country has no type specified.
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\Leaderboard\Leaderboard.php
</span></span><span class=line><span class=cl> ------ -------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  17     Method RacingCar\Leaderboard\Leaderboard::getDriverResults() has no return type specified.
</span></span><span class=line><span class=cl>  32     Method RacingCar\Leaderboard\Leaderboard::getDriverRankings() return type has no value type specified in iterable type array.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/blog/solving-phpstan-no-value-type-specified-in-iterable-type
</span></span><span class=line><span class=cl> ------ -------------------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\Leaderboard\Race.php
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  9      Property RacingCar\Leaderboard\Race::$points type has no value type specified in iterable type array.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/blog/solving-phpstan-no-value-type-specified-in-iterable-type
</span></span><span class=line><span class=cl>  11     Property RacingCar\Leaderboard\Race::$driverNames type has no value type specified in iterable type array.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/blog/solving-phpstan-no-value-type-specified-in-iterable-type
</span></span><span class=line><span class=cl>  17     Property RacingCar\Leaderboard\Race::$name is never read, only written.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/developing-extensions/always-read-written-properties
</span></span><span class=line><span class=cl>  31     Method RacingCar\Leaderboard\Race::getPosition() has parameter $driver with no type specified.
</span></span><span class=line><span class=cl>  33     Method RacingCar\Leaderboard\Race::getPosition() should return int but returns int|string|false.
</span></span><span class=line><span class=cl>  41     Method RacingCar\Leaderboard\Race::getResults() return type has no value type specified in iterable type array.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/blog/solving-phpstan-no-value-type-specified-in-iterable-type
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\Leaderboard\SelfDrivingCar.php
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  9      Property RacingCar\Leaderboard\SelfDrivingCar::$algorithmVersion has no type specified.
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TelemetrySystem\TelemetryClient.php
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  98     Method RacingCar\TelemetrySystem\TelemetryClient::getOnlineStatus() has no return type specified.
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TelemetrySystem\TelemetryDiagnosticControls.php
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  13     Property RacingCar\TelemetrySystem\TelemetryDiagnosticControls::$diagnosticInfo has no type specified.
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TextConverter\HtmlPagesConverter.php
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  9      Property RacingCar\TextConverter\HtmlPagesConverter::$breaks type has no value type specified in iterable type array.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/blog/solving-phpstan-no-value-type-specified-in-iterable-type
</span></span><span class=line><span class=cl>  16     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl>  19     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  20     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  23     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  24     Parameter #1 $stream of function fclose expects resource, resource|false given.
</span></span><span class=line><span class=cl>  32     Parameter #1 $stream of function fseek expects resource, resource|false given.
</span></span><span class=line><span class=cl>  34     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  35     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl>  35     Parameter #1 $string of function rtrim expects string, string|false given.
</span></span><span class=line><span class=cl>  42     Parameter #1 $stream of function fclose expects resource, resource|false given.
</span></span><span class=line><span class=cl>  46     Method RacingCar\TextConverter\HtmlPagesConverter::getFileName() has no return type specified.
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TextConverter\HtmlTextConverter.php
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  19     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl>  27     Method RacingCar\TextConverter\HtmlTextConverter::getFileName() has no return type specified.
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TirePressureMonitoring\Sensor.php
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  14     Method RacingCar\TirePressureMonitoring\Sensor::popNextPressurePsiValue() has no return type specified.
</span></span><span class=line><span class=cl>  21     Method RacingCar\TirePressureMonitoring\Sensor::getSamplePressure() has no return type specified.
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TurnTicketDispenser\TicketDispenser.php
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  9      Method RacingCar\TurnTicketDispenser\TicketDispenser::getTurnTicket() has no return type specified.
</span></span><span class=line><span class=cl> ------ -----------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TurnTicketDispenser\TurnNumberSequence.php
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  11     Method RacingCar\TurnTicketDispenser\TurnNumberSequence::nextTurn() has no return type specified.
</span></span><span class=line><span class=cl> ------ ---------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TurnTicketDispenser\TurnTicket.php
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  14     Method RacingCar\TurnTicketDispenser\TurnTicket::getTurnNumber() has no return type specified.
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   tests\Leaderboard\LeaderboardTest.php
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  37     Property Tests\Leaderboard\LeaderboardTest::$sampleLeaderboard2 is never read, only written.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/developing-extensions/always-read-written-properties
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> [ERROR] Found 33 errors
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Script phpstan analyse --ansi handling the phpstan event returned with error code 1
</span></span></code></pre></div><div class="flex px-4 py-3 rounded-md bg-primary-100 dark:bg-primary-900"><span class="text-primary-400 ltr:pr-3 rtl:pl-3"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M506.3 417 293 53c-16.33-28-57.54-28-73.98.0l-213.2 364C-10.59 444.9 9.849 480 42.74 480h426.6c32.76.0 53.26-35 36.96-63zM232 168c0-13.25 10.75-24 24-24s24 10.8 24 24v128c0 13.25-10.75 24-23.1 24S232 309.3 232 296V168zm24 248c-17.36.0-31.44-14.08-31.44-31.44s14.07-31.44 31.44-31.44 31.44 14.08 31.44 31.44C287.4 401.9 273.4 416 256 416z"/></svg></span></span><span class=dark:text-neutral-300>PhpStan is currently set to <strong>max</strong>, which is the strictest mode.</span></div><p>Both ECS and Rector have automatic code fixes, unfortunately, there are no PhpStan automatic fixes.</p><p>Most of the problems are <strong>no type specified</strong> (for a property) and <strong>no return type</strong> (returned from a method). It&rsquo;s a
case of looking at each file, one by one, and <strong>manually</strong> working out the types. I may run the test with coverage to
check which test is covering the code and see the input parameters.</p><p>Example (Driver.php):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>---public $name;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++public ?string $name;
</span></span></span><span class=line><span class=cl><span class=gi></span>
</span></span><span class=line><span class=cl><span class=gd>---public $country;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++public string $country;
</span></span></span><span class=line><span class=cl><span class=gi></span>
</span></span><span class=line><span class=cl>public function __construct(?string $name, string $country)
</span></span><span class=line><span class=cl>// ...
</span></span></code></pre></div><p>Oddly this wasn&rsquo;t updated to php 8 standard, now the types have been added, <strong>Rector</strong> can be re-run.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>vendor<span class=se>\b</span>in<span class=se>\r</span>ector.bat
</span></span><span class=line><span class=cl><span class=c1># or vendor/bin/rector</span>
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl> class Driver implements \Stringable
</span></span><span class=line><span class=cl> {
</span></span><span class=line><span class=cl><span class=gd>---    public ?string $name;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gs>---
</span></span></span><span class=line><span class=cl><span class=gs></span><span class=gd>---    public string $country;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gs>---
</span></span></span><span class=line><span class=cl><span class=gs></span><span class=gd>---    public function __construct(?string $name, string $country)
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++    public function __construct(public ?string $name, public string $country)
</span></span></span><span class=line><span class=cl><span class=gi></span>     {
</span></span><span class=line><span class=cl><span class=gd>---        $this-&gt;name = $name;
</span></span></span><span class=line><span class=cl><span class=gd>---        $this-&gt;country = $country;
</span></span></span><span class=line><span class=cl><span class=gd></span>     }
</span></span></code></pre></div><p>Nice! That class has now been updated.</p><p><strong>ECS</strong> can be re-run to clean up any code standard issues.</p><p>Re-running <strong>ps.bat</strong> confirms we are down to 31 errors. I’ll look at the remaining <strong>no type specified</strong>:</p><p>src\Leaderboard\SelfDrivingCar.php line 9</p><p>The type was in the constructor:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>---public $algorithmVersion;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++public string $algorithmVersion;
</span></span></span><span class=line><span class=cl><span class=gi></span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>public function __construct(string $algorithmVersion, string $company)
</span></span></code></pre></div><p>src\TelemetrySystem\TelemetryDiagnosticControls.php line 10</p><p>Based on the default value, the type is a string. Checking the
usage <code>$this->diagnosticInfo = $this->telemetryClient->receive();</code> confirm the return type from the
method <code>receive(): string</code> is a string</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-diff data-lang=diff><span class=line><span class=cl><span class=gd>---public $diagnosticInfo = &#39;&#39;;
</span></span></span><span class=line><span class=cl><span class=gd></span><span class=gi>+++public string $diagnosticInfo = &#39;&#39;;
</span></span></span></code></pre></div><h3 id=rinse-and-repeat class="relative group">Rinse and repeat <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#rinse-and-repeat aria-label=Anchor>#</a></span></h3><p>Again <strong>Rector</strong> can be run, <strong>ECS</strong> and <strong>PHPUnit</strong> then re-run <strong>PhpStan</strong>.</p><p>Down to 29 errors!</p><p>Next, no return type is specified, this means each method has to be manually checked. If it has a <code>return</code> the type will
need to be added, otherwise, it is void.</p><ul><li>RacingCar\Leaderboard\Leaderboard::getDriverResults()</li></ul><p>Is an array.</p><ul><li>RacingCar\TelemetrySystem\TelemetryClient::getOnlineStatus()</li></ul><p>Is returning $this->onlineStatus with is a bool</p><ul><li>RacingCar\TextConverter\HtmlTextConverter::getFileName()</li></ul><p>Is returning $this->fullFileNameWithPath, which is a string</p><ul><li>RacingCar\TirePressureMonitoring\Sensor::popNextPressurePsiValue() is a float.</li><li>RacingCar\TirePressureMonitoring\Sensor::getSamplePressure() is a float.</li><li>RacingCar\TurnTicketDispenser\TicketDispenser::getTurnTicket(): TurnTicket</li><li>RacingCar\TurnTicketDispenser\TurnNumberSequence::nextTurn(): int</li><li>RacingCar\TurnTicketDispenser\TurnTicket::getTurnNumber(): int</li><li>RacingCar\TextConverter\HtmlPagesConverter::getFileName(): string</li><li>RacingCar\Leaderboard\Race::getPosition() has parameter $driver with no type specified. Is a Driver</li><li>public function getPoints(Driver $driver): int</li></ul><p>Down to 20 errors! Only 5 files (Classes).</p><p>Next, we can look at the next highest item <strong>return type has no value type specified in iterable type array.</strong>, this is
purely a PhpStan error, it needs to know the types of the array so further static analysis can help us. We need to add
some doc block information about the array, advising the structure.</p><ul><li>src\Leaderboard\Leaderboard.php</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>* @return array&lt;string, int&gt;
</span></span></span><span class=line><span class=cl><span class=sd>*/</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>getDriverResults</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span><span class=line><span class=cl><span class=c1>//…
</span></span></span><span class=line><span class=cl><span class=c1></span>
</span></span><span class=line><span class=cl><span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>* @return int[]|string[]
</span></span></span><span class=line><span class=cl><span class=sd>*/</span>
</span></span><span class=line><span class=cl><span class=k>public</span> <span class=k>function</span> <span class=nf>getDriverRankings</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span></code></pre></div><ul><li>src\Leaderboard\Race.php</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>  <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>  * @var int[]
</span></span></span><span class=line><span class=cl><span class=sd>  */</span>
</span></span><span class=line><span class=cl>  <span class=k>private</span> <span class=k>static</span> <span class=k>array</span> <span class=nv>$points</span> <span class=o>=</span> <span class=p>[</span><span class=mi>25</span><span class=p>,</span> <span class=mi>18</span><span class=p>,</span> <span class=mi>15</span><span class=p>];</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>  * @var array&lt;string, string|null&gt;
</span></span></span><span class=line><span class=cl><span class=sd>  */</span>
</span></span><span class=line><span class=cl>  <span class=k>private</span> <span class=k>array</span> <span class=nv>$driverNames</span><span class=p>;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>  * @return Driver[]
</span></span></span><span class=line><span class=cl><span class=sd>  */</span>
</span></span><span class=line><span class=cl>  <span class=k>public</span> <span class=k>function</span> <span class=nf>getResults</span><span class=p>()</span><span class=o>:</span> <span class=k>array</span>
</span></span></code></pre></div><ul><li>src\TextConverter\HtmlPagesConverter.php</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-php data-lang=php><span class=line><span class=cl>  <span class=sd>/**
</span></span></span><span class=line><span class=cl><span class=sd>  * @var int[]
</span></span></span><span class=line><span class=cl><span class=sd>  */</span>
</span></span><span class=line><span class=cl>  <span class=k>private</span> <span class=k>array</span> <span class=nv>$breaks</span><span class=p>;</span>
</span></span></code></pre></div><p>There are now 17 errors, as PhpStan &ldquo;knows more&rdquo; about the code, other errors have been generated:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-text data-lang=text><span class=line><span class=cl>  Line   src\Leaderboard\Race.php
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  23     Property RacingCar\Leaderboard\Race::$name is never read, only written.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/developing-extensions/always-read-written-properties
</span></span><span class=line><span class=cl>  39     Method RacingCar\Leaderboard\Race::getPosition() should return int but returns int|string|false.
</span></span><span class=line><span class=cl>  57     Method RacingCar\Leaderboard\Race::getDriverName() should return string but returns string|null.
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TextConverter\HtmlPagesConverter.php
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  19     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl>  22     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  23     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  23     Property RacingCar\TextConverter\HtmlPagesConverter::$breaks (array&lt;int&gt;) does not accept array&lt;bool|int&gt;.
</span></span><span class=line><span class=cl>  26     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  26     Property RacingCar\TextConverter\HtmlPagesConverter::$breaks (array&lt;int&gt;) does not accept array&lt;bool|int&gt;.
</span></span><span class=line><span class=cl>  27     Parameter #1 $stream of function fclose expects resource, resource|false given.
</span></span><span class=line><span class=cl>  40     Parameter #1 $stream of function fseek expects resource, resource|false given.
</span></span><span class=line><span class=cl>  42     Parameter #1 $stream of function ftell expects resource, resource|false given.
</span></span><span class=line><span class=cl>  43     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl>  43     Parameter #1 $string of function rtrim expects string, string|false given.
</span></span><span class=line><span class=cl>  50     Parameter #1 $stream of function fclose expects resource, resource|false given.
</span></span><span class=line><span class=cl> ------ ------------------------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   src\TextConverter\HtmlTextConverter.php
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  19     Parameter #1 $stream of function fgets expects resource, resource|false given.
</span></span><span class=line><span class=cl> ------ --------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  Line   tests\Leaderboard\LeaderboardTest.php
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>  37     Property Tests\Leaderboard\LeaderboardTest::$sampleLeaderboard2 is never read, only written.
</span></span><span class=line><span class=cl>         � See: https://phpstan.org/developing-extensions/always-read-written-properties
</span></span><span class=line><span class=cl> ------ ----------------------------------------------------------------------------------------------
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl> [ERROR] Found 17 errors
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Script phpstan analyse --ansi handling the phpstan event returned with error code 1
</span></span></code></pre></div><p>Running <strong>Rector</strong>, <strong>ECS</strong> and <strong>PHPUnit</strong>, everything is working and to the correct standard.</p><p>The starter code to a Kata, the description:</p><blockquote><p>For each exercise, you should identify which SOLID principles are not being followed by the code. There is only one
class you are interested in writing tests for right now. As a first step, try to get some kind of test in place before
you change the class at all. If the tests are hard to write, is that because of the problems with SOLID principles?</p></blockquote><p>This starter code needs to be refactored. I’m happy the class structure is now PHP 8 standard, it’s now ready for
someone to start the exercise.</p><p>The remaining errors need the code to be refactored to check for errors such as the file existing.</p><p>I will, therefore, PR this code as the PHP starting point for the Kata.</p><h3 id=remove-rector class="relative group">Remove Rector <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#remove-rector aria-label=Anchor>#</a></span></h3><p>Before I PR the code <strong>Rector</strong> and the <strong>rector.php</strong> config file needs to be removed:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-shell data-lang=shell><span class=line><span class=cl>composer remove rector/rector --dev
</span></span><span class=line><span class=cl>rm rector.php
</span></span></code></pre></div><h2 id=pull-request-pr class="relative group">Pull Request (PR) <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#pull-request-pr aria-label=Anchor>#</a></span></h2><p>If you are interested the PR was successful, the full diff, of every change, can be
seen <a href=https://github.com/emilybache/Racing-Car-Katas/pull/54/commits/6a5189b70a824c3babc341366d669282e8e3757f target=_blank>Bump to PHP 8.0+</a></p><h2 id=php-katas class="relative group">PHP Katas <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#php-katas aria-label=Anchor>#</a></span></h2><p>The eight Katas with PHP versions can be run by anyone (diff for information):</p><ol><li><a href=https://github.com/emilybache/GildedRose-Refactoring-Kata target=_blank>Gilded Rose Refactoring Kata</a> - (<a href=https://github.com/emilybache/GildedRose-Refactoring-Kata/commit/081c69b864b8213a096847ace77395d5d8a4a3fe target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Tennis-Refactoring-Kata target=_blank>Tennis Refactoring Kata</a> - (<a href=https://github.com/emilybache/Tennis-Refactoring-Kata/commit/6d3cf933be55bb70e11e39267709f80586412c30 target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Parrot-Refactoring-Kata target=_blank>Parrot Refactoring Kata</a> - (<a href=https://github.com/emilybache/Parrot-Refactoring-Kata/commit/261963a7a8a7ebee57584aa4bc5639ea6a29a743 target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/SupermarketReceipt-Refactoring-Kata target=_blank>The Supermarket Receipt Refactoring Kata</a> - (<a href=https://github.com/emilybache/SupermarketReceipt-Refactoring-Kata/commit/280c2e90734550fdb7d2f6c140539a93d0e254a1 target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Theatrical-Players-Refactoring-Kata target=_blank>Theatrical Players Refactoring Kata</a> - (<a href=https://github.com/emilybache/Theatrical-Players-Refactoring-Kata/commit/f1dca24d1f3d53635c0aba63e4c8424501db6025 target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Yatzy-Refactoring-Kata target=_blank>Yatzy Refactoring Kata</a> - (<a href=https://github.com/emilybache/Yatzy-Refactoring-Kata/pull/24/commits/07c60c79c84add3bcffe2b7ce916bc84c583fec4 target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Lift-Kata target=_blank>Lift Kata</a> - (<a href=https://github.com/emilybache/Lift-Kata/commit/26425b01a5981105923dfafb366c81ca3352258a target=_blank>diff</a>)</li><li><a href=https://github.com/emilybache/Racing-Car-Katas target=_blank>Racing Car Katas</a> - (<a href=https://github.com/emilybache/Racing-Car-Katas/pull/54/commits/6a5189b70a824c3babc341366d669282e8e3757f target=_blank>diff</a>)</li></ol><p>Anyone new to Kata and refactoring I would recommend the <strong>Theatrical Players Refactoring Kata</strong> first. It is a code
along with the first chapter of &lsquo;Refactoring&rsquo; by Martin Fowler, 2nd Edition, using Javascript. I would even go so far
as to say to do the Javascript version first, then redo the PHP version.</p><p>Then I would recommend the Parrot or Tennis or Yatzy Kata. One of the most time-consuming Kata is the Gilded Rose, as
this starts with no tests, and then it needs refactoring before the new feature can be added.</p><p>I wish everyone good luck with these Kata, they helped me to level up my knowledge. The confidence tests give when
refactoring code is immeasurable.</p><h2 id=conclusion class="relative group">Conclusion <span class="absolute top-0 w-6 transition-opacity opacity-0 ltr:-left-6 rtl:-right-6 not-prose group-hover:opacity-100"><a class="group-hover:text-primary-300 dark:group-hover:text-neutral-700" style=text-decoration-line:none!important href=#conclusion aria-label=Anchor>#</a></span></h2><p>In summary, I upgraded eight PHP katas to make them consistent, and easy for someone to clone and run. They are a great
way to learn about refactoring code, especially when that code is well-tested, which then gives the confidence to
refactor. I hope other PHP developers find these Kata’s useful, as I have.</p><p>This upgrade has given me valuable experience in how to upgrade an existing code base. I now have a better understanding
of how <strong>Rector</strong> works. I use <strong>ECS</strong>, <strong>PhpStan</strong> and <strong>PHPUnit</strong> in my existing projects, thanks to exercises I did,
like this, several years ago. When I have production code which requires an upgrade I will have more confidence to
use <strong>Rector</strong>.</p><p>I hope this blog will help others to use the fantastic tools available to PHP developers, to help us write our code.</p></div></section><footer class="pt-8 max-w-prose print:hidden"><div class=flex><img class="!mt-0 !mb-0 h-24 w-24 rounded-full ltr:mr-4 rtl:ml-4" width=96 height=96 alt="Michael Pritchard (AKA Pen-y-Fan)" src=/img/author_hu5893a0bcecd6e8dce34dc674da9c7f56_6794556_192x192_fill_q75_box_smart1.jpg><div class=place-self-center><div class="text-[0.6rem] uppercase leading-3 text-neutral-500 dark:text-neutral-400">Author</div><div class="font-semibold leading-6 text-neutral-800 dark:text-neutral-300">Michael Pritchard (AKA Pen-y-Fan)</div><div class="text-sm text-neutral-700 dark:text-neutral-400">Posts about my coding experiences, primarily for my learning path with PHP, good clean professional code.</div><div class="text-2xl sm:text-lg"><div class="flex flex-wrap text-neutral-400 dark:text-neutral-500"><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" href=https://github.com/Pen-y-Fan target=_blank aria-label=Github rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.linkedin.com/in/michael-pritchard-340b4520/ target=_blank aria-label=Linkedin rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" href=https://www.reddit.com/user/Pen-y-Fan target=_blank aria-label=Reddit rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a class="px-1 transition-transform hover:scale-125 hover:text-primary-700 dark:hover:text-primary-400" href=https://twitter.com/MikeAPritch target=_blank aria-label=Twitter rel="me noopener noreferrer"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a></div></div></div></div><section class="flex flex-row flex-wrap justify-center pt-4 text-xl"><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.facebook.com/sharer/sharer.php?u=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;quote=How%20I%20upgraded%20eight%20PHP%20katas" title="Share on Facebook" aria-label="Share on Facebook"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M504 256C504 119 393 8 256 8S8 119 8 256c0 123.78 90.69 226.38 209.25 245V327.69h-63V256h63v-54.64c0-62.15 37-96.48 93.67-96.48 27.14.0 55.52 4.84 55.52 4.84v61h-31.28c-30.8.0-40.41 19.12-40.41 38.73V256h68.78l-11 71.69h-57.78V501C413.31 482.38 504 379.78 504 256z"/></svg></span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://twitter.com/intent/tweet/?url=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;text=How%20I%20upgraded%20eight%20PHP%20katas" title="Tweet on Twitter" aria-label="Tweet on Twitter"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://pinterest.com/pin/create/bookmarklet/?url=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;description=How%20I%20upgraded%20eight%20PHP%20katas" title="Pin on Pinterest" aria-label="Pin on Pinterest"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="currentcolor" d="M496 256c0 137-111 248-248 248-25.6.0-50.2-3.9-73.4-11.1 10.1-16.5 25.2-43.5 30.8-65 3-11.6 15.4-59 15.4-59 8.1 15.4 31.7 28.5 56.8 28.5 74.8.0 128.7-68.8 128.7-154.3.0-81.9-66.9-143.2-152.9-143.2-107 0-163.9 71.8-163.9 150.1.0 36.4 19.4 81.7 50.3 96.1 4.7 2.2 7.2 1.2 8.3-3.3.8-3.4 5-20.3 6.9-28.1.6-2.5.3-4.7-1.7-7.1-10.1-12.5-18.3-35.3-18.3-56.6.0-54.7 41.4-107.6 112-107.6 60.9.0 103.6 41.5 103.6 100.9.0 67.1-33.9 113.6-78 113.6-24.3.0-42.6-20.1-36.7-44.8 7-29.5 20.5-61.3 20.5-82.6.0-19-10.2-34.9-31.4-34.9-24.9.0-44.9 25.7-44.9 60.2.0 22 7.4 36.8 7.4 36.8s-24.5 103.8-29 123.2c-5 21.4-3 51.6-.9 71.2C65.4 450.9.0 361.1.0 256 0 119 111 8 248 8s248 111 248 248z"/></svg></span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://reddit.com/submit/?url=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;resubmit=true&amp;title=How%20I%20upgraded%20eight%20PHP%20katas" title="Submit to Reddit" aria-label="Submit to Reddit"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M201.5 305.5c-13.8.0-24.9-11.1-24.9-24.6.0-13.8 11.1-24.9 24.9-24.9 13.6.0 24.6 11.1 24.6 24.9.0 13.6-11.1 24.6-24.6 24.6zM504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zm-132.3-41.2c-9.4.0-17.7 3.9-23.8 10-22.4-15.5-52.6-25.5-86.1-26.6l17.4-78.3 55.4 12.5c0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.3 24.9-24.9s-11.1-24.9-24.9-24.9c-9.7.0-18 5.8-22.1 13.8l-61.2-13.6c-3-.8-6.1 1.4-6.9 4.4l-19.1 86.4c-33.2 1.4-63.1 11.3-85.5 26.8-6.1-6.4-14.7-10.2-24.1-10.2-34.9.0-46.3 46.9-14.4 62.8-1.1 5-1.7 10.2-1.7 15.5.0 52.6 59.2 95.2 132 95.2 73.1.0 132.3-42.6 132.3-95.2.0-5.3-.6-10.8-1.9-15.8 31.3-16 19.8-62.5-14.9-62.5zM302.8 331c-18.2 18.2-76.1 17.9-93.6.0-2.2-2.2-6.1-2.2-8.3.0-2.5 2.5-2.5 6.4.0 8.6 22.8 22.8 87.3 22.8 110.2.0 2.5-2.2 2.5-6.1.0-8.6-2.2-2.2-6.1-2.2-8.3.0zm7.7-75c-13.6.0-24.6 11.1-24.6 24.9.0 13.6 11.1 24.6 24.6 24.6 13.8.0 24.9-11.1 24.9-24.6.0-13.8-11-24.9-24.9-24.9z"/></svg></span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;title=How%20I%20upgraded%20eight%20PHP%20katas" title="Share on LinkedIn" aria-label="Share on LinkedIn"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="currentcolor" d="M416 32H31.9C14.3 32 0 46.5.0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6.0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3.0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2.0 38.5 17.3 38.5 38.5.0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6.0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2.0 79.7 44.3 79.7 101.9V416z"/></svg></span></a><a class="m-1 inline-block min-w-[2.4rem] rounded bg-neutral-300 p-1 text-center text-neutral-700 hover:bg-primary-500 hover:text-neutral dark:bg-neutral-700 dark:text-neutral-300 dark:hover:bg-primary-400 dark:hover:text-neutral-800" href="mailto:?body=https://pen-y-fan.github.io/2023/01/22/how-i-upgraded-eight-php-katas/&amp;subject=How%20I%20upgraded%20eight%20PHP%20katas" title="Send via email" aria-label="Send via email"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M207.8 20.73c-93.45 18.32-168.7 93.66-187 187.1-27.64 140.9 68.65 266.2 199.1 285.1 19.01 2.888 36.17-12.26 36.17-31.49l1e-4-.6631c0-15.74-11.44-28.88-26.84-31.24-84.35-12.98-149.2-86.13-149.2-174.2.0-102.9 88.61-185.5 193.4-175.4 91.54 8.869 158.6 91.25 158.6 183.2v16.16c0 22.09-17.94 40.05-40 40.05s-40.01-17.96-40.01-40.05v-120.1c0-8.847-7.161-16.02-16.01-16.02l-31.98.0036c-7.299.0-13.2 4.992-15.12 11.68-24.85-12.15-54.24-16.38-86.06-5.106-38.75 13.73-68.12 48.91-73.72 89.64-9.483 69.01 43.81 128 110.9 128 26.44.0 50.43-9.544 69.59-24.88 24 31.3 65.23 48.69 109.4 37.49C465.2 369.3 496 324.1 495.1 277.2V256.3c0-149.2-133.9-265.632-287.3-235.57zM239.1 304.3c-26.47.0-48-21.56-48-48.05s21.53-48.05 48-48.05 48 21.56 48 48.05-20.6 48.05-48 48.05z"/></svg></span></a></section><div class=pt-8><hr class="border-dotted border-neutral-300 dark:border-neutral-600"><div class="flex justify-between pt-3"><span><a class="group flex" href=/2023/01/15/how-to-update-the-php-version-in-laragon/><span class="mr-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&larr;</span>
<span class="ml-2 text-neutral-700 transition-transform group-hover:translate-x-[2px] group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">How to update the PHP version in Laragon</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2023-01-15 18:52:54 +0000 UTC">15 January 2023</time></span></span></a></span>
<span><a class="group flex text-right" href=/2023/01/28/how-to-run-cron-jobs-on-windows/><span class="flex flex-col"><span class="mt-[0.1rem] leading-6 group-hover:underline group-hover:decoration-primary-500">How to run cron jobs on Windows</span>
<span class="mt-[0.1rem] text-xs text-neutral-500 dark:text-neutral-400"><time datetime="2023-01-28 17:29:43 +0000 UTC">28 January 2023</time></span></span>
<span class="ml-2 text-neutral-700 transition-transform group-hover:translate-x-[2px] group-hover:text-primary-600 ltr:inline rtl:hidden dark:text-neutral dark:group-hover:text-primary-400">&rarr;</span>
<span class="mr-2 text-neutral-700 transition-transform group-hover:-translate-x-[2px] group-hover:text-primary-600 ltr:hidden rtl:inline dark:text-neutral dark:group-hover:text-primary-400">&larr;</span></a></span></div></div></footer></article><div class="pointer-events-none absolute top-[100vh] bottom-0 w-12 ltr:right-0 rtl:left-0"><a href=#the-top class="pointer-events-auto sticky top-[calc(100vh-5.5rem)] flex h-12 w-12 items-center justify-center rounded-full bg-neutral/50 text-xl text-neutral-700 backdrop-blur hover:text-primary-600 dark:bg-neutral-800/50 dark:text-neutral dark:hover:text-primary-400" aria-label="Scroll to top" title="Scroll to top">&uarr;</a></div></main><footer class="py-10 print:hidden"><div class="flex items-center justify-between"><div><p class="text-sm text-neutral-500 dark:text-neutral-400">©️ Attribution-ShareAlike 4.0 International (CC BY-SA 4.0)</p><p class="text-xs text-neutral-500 dark:text-neutral-400">Powered by <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://gohugo.io/ target=_blank rel="noopener noreferrer">Hugo</a> & <a class="hover:underline hover:decoration-primary-400 hover:text-primary-500" href=https://git.io/hugo-congo target=_blank rel="noopener noreferrer">Congo</a></p></div><div class="ltr:mr-14 rtl:ml-14 cursor-pointer text-sm text-neutral-700 hover:text-primary-600 dark:text-neutral dark:hover:text-primary-400"><button id=appearance-switcher type=button><div class="flex items-center justify-center w-12 h-12 dark:hidden" title="Switch to dark appearance"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M32 256C32 132.2 132.3 32 255.8 32c11.36.0 29.7 1.668 40.9 3.746 9.616 1.777 11.75 14.63 3.279 19.44C245 86.5 211.2 144.6 211.2 207.8c0 109.7 99.71 193 208.3 172.3 9.561-1.805 16.28 9.324 10.11 16.95C387.9 448.6 324.8 480 255.8 480 132.1 480 32 379.6 32 256z"/></svg></span></div><div class="items-center justify-center hidden w-12 h-12 dark:flex" title="Switch to light appearance"><span class="relative inline-block align-text-bottom icon"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="currentcolor" d="M256 159.1c-53.02.0-95.1 42.98-95.1 95.1s41.2 96.9 95.1 96.9 95.1-42.98 95.1-95.1S309 159.1 256 159.1zM509.3 347l-63.2-91.9 63.15-91.01c6.332-9.125 1.104-21.74-9.826-23.72l-109-19.7-19.7-109c-1.975-10.93-14.59-16.16-23.72-9.824L256 65.89 164.1 2.736c-9.125-6.332-21.74-1.107-23.72 9.824L121.6 121.6 12.56 141.3C1.633 143.2-3.596 155.9 2.736 164.1L65.89 256 2.74 347.01c-6.332 9.125-1.105 21.74 9.824 23.72l109 19.7 19.7 109c1.975 10.93 14.59 16.16 23.72 9.824L256 446.1l91.01 63.15c9.127 6.334 21.75 1.107 23.72-9.822l19.7-109 109-19.7C510.4 368.8 515.6 356.1 509.3 347zM256 383.1c-70.69.0-127.1-57.31-127.1-127.1.0-70.69 57.31-127.1 127.1-127.1S383.1 186.2 383.1 256c0 70.7-56.4 127.1-127.1 127.1z"/></svg></span></div></button></div></div></footer></div></body></html>